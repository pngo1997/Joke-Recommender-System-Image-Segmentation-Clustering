<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Student Name: Mai Ngo<a rel="noopener" class="anchor-link" href="#Student-Name:-Mai-Ngo">&#182;</a></h4><h4>Course Name and Number: DSC 478 Programming Machine Learning Applications<a rel="noopener" class="anchor-link" href="#Course-Name-and-Number:-DSC-478-Programming-Machine-Learning-Applications">&#182;</a></h4><h4>Assignment 4<a rel="noopener" class="anchor-link" href="#Assignment-4">&#182;</a></h4><h4>Date: 6/4/2023<a rel="noopener" class="anchor-link" href="#Date:-6/4/2023">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Part A. Recommender system.<a rel="noopener" class="anchor-link" href="#Part-A.-Recommender-system.">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For this problem you will use a modified version of the item-based recommender algorithm from Ch. 14 of Machine Learning in Action and use it on joke ratings data based on Jester Online Joke Recommender System. The modified version of the code is provided in the module itemBasedRec.py. Most of the module will be used as is, but you will add some additional functionality.</p>
<p>The data set contains two files. The file &quot;modified_jester_data.csv&quot; contains the ratings on 100 jokes by 1000 users (each row is a user profile). The ratings have been normalized to be between 1 and 21 (a 20-point scale), with 1 being the lowest rating. A zero indicated a missing rating. The file &quot;jokes.csv&quot; contains the joke ids mapped to the actual text of the jokes.</p>
<p>Your tasks in this problem are the following (please also see comments for the function stubs in the provided module):</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>a. Load in the joke ratings data and the joke text data into appropriate data structures.<a rel="noopener" class="anchor-link" href="#a.-Load-in-the-joke-ratings-data-and-the-joke-text-data-into-appropriate-data-structures.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jokeRating</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;modified_jester_data.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">jokeRating</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">jokeRating</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#Read data as Pandas dataframe and get number of rows and columns, print first 10 observations.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Data shape: (1000, 100)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.18</td>
      <td>19.79</td>
      <td>1.34</td>
      <td>2.84</td>
      <td>3.48</td>
      <td>2.50</td>
      <td>1.15</td>
      <td>15.17</td>
      <td>2.02</td>
      <td>6.24</td>
      <td>...</td>
      <td>13.82</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5.37</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.08</td>
      <td>10.71</td>
      <td>17.36</td>
      <td>15.37</td>
      <td>8.62</td>
      <td>1.34</td>
      <td>10.27</td>
      <td>5.66</td>
      <td>19.88</td>
      <td>20.22</td>
      <td>...</td>
      <td>13.82</td>
      <td>6.05</td>
      <td>10.71</td>
      <td>18.86</td>
      <td>10.81</td>
      <td>8.86</td>
      <td>14.06</td>
      <td>11.34</td>
      <td>6.68</td>
      <td>12.07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>20.03</td>
      <td>20.27</td>
      <td>20.03</td>
      <td>20.27</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>20.08</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>19.35</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12.80</td>
      <td>19.16</td>
      <td>8.18</td>
      <td>17.21</td>
      <td>0.00</td>
      <td>12.84</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>11.53</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19.50</td>
      <td>15.61</td>
      <td>6.83</td>
      <td>5.61</td>
      <td>12.36</td>
      <td>12.60</td>
      <td>18.04</td>
      <td>15.61</td>
      <td>10.56</td>
      <td>16.73</td>
      <td>...</td>
      <td>16.19</td>
      <td>16.58</td>
      <td>15.27</td>
      <td>16.19</td>
      <td>16.73</td>
      <td>12.55</td>
      <td>14.11</td>
      <td>17.55</td>
      <td>12.80</td>
      <td>12.60</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.83</td>
      <td>7.46</td>
      <td>11.44</td>
      <td>2.50</td>
      <td>3.91</td>
      <td>6.68</td>
      <td>2.31</td>
      <td>10.13</td>
      <td>4.35</td>
      <td>9.20</td>
      <td>...</td>
      <td>7.46</td>
      <td>4.11</td>
      <td>10.32</td>
      <td>8.04</td>
      <td>8.82</td>
      <td>7.65</td>
      <td>11.05</td>
      <td>1.92</td>
      <td>5.95</td>
      <td>7.55</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>19.59</td>
      <td>1.15</td>
      <td>18.72</td>
      <td>19.79</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>13.33</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17.84</td>
      <td>14.16</td>
      <td>20.17</td>
      <td>4.79</td>
      <td>2.84</td>
      <td>9.30</td>
      <td>20.27</td>
      <td>12.41</td>
      <td>5.81</td>
      <td>6.58</td>
      <td>...</td>
      <td>18.23</td>
      <td>9.88</td>
      <td>10.90</td>
      <td>5.32</td>
      <td>7.84</td>
      <td>7.65</td>
      <td>13.14</td>
      <td>10.95</td>
      <td>12.31</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7.21</td>
      <td>7.46</td>
      <td>1.58</td>
      <td>4.11</td>
      <td>2.26</td>
      <td>10.71</td>
      <td>5.71</td>
      <td>2.07</td>
      <td>3.14</td>
      <td>9.40</td>
      <td>...</td>
      <td>15.37</td>
      <td>10.71</td>
      <td>15.17</td>
      <td>10.71</td>
      <td>10.71</td>
      <td>10.71</td>
      <td>10.71</td>
      <td>10.71</td>
      <td>7.60</td>
      <td>6.05</td>
    </tr>
    <tr>
      <th>9</th>
      <td>14.01</td>
      <td>16.15</td>
      <td>16.15</td>
      <td>14.01</td>
      <td>17.41</td>
      <td>16.15</td>
      <td>19.93</td>
      <td>13.52</td>
      <td>14.01</td>
      <td>19.16</td>
      <td>...</td>
      <td>0.00</td>
      <td>15.47</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>10 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jokeText</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;jokes.csv&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">jokeText</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">jokeText</span> <span class="o">=</span> <span class="n">jokeText</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">jokeText</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="c1">#Read data as numpy array and get number of rows and columns, print first 10 observations.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Data shape: (100, 2)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([&#39;A man visits the doctor. The doctor says &quot;I have bad news for you.You have cancer and Alzheimer\&#39;s disease&quot;. The man replies &quot;Well thank God I don\&#39;t have cancer!&quot;&#39;,
       &#39;This couple had an excellent relationship going until one day he came home from work to find his girlfriend packing. He asked her why she was leaving him and she told him that she had heard awful things about him. &quot;What could they possibly have said to make you move out?&quot; &quot;They told me that you were a pedophile.&quot; He replied &quot;That\&#39;s an awfully big word for a ten year old.&quot;&#39;,
       &quot;Q. What&#39;s 200 feet long and has 4 teeth? A. The front row at a Willie Nelson Concert.&quot;,
       &quot;Q. What&#39;s the difference between a man and a toilet? A. A toilet doesn&#39;t follow you around after you use it.&quot;,
       &quot;Q. What&#39;s O. J. Simpson&#39;s Internet address? A.\tSlash slash backslash slash slash escape.&quot;,
       &quot;Bill &amp; Hillary are on a trip back to Arkansas. They&#39;re almost out of gas so Bill pulls into a service station on the outskirts of town. The attendant runs out of the station to serve them when Hillary realizes it&#39;s an old boyfriend from high school. She and the attendant chat as he gases up their car and cleans the windows. Then they all say good-bye. As Bill pulls the car onto the road he turns to Hillary and says &#39;Now aren&#39;t you glad you married me and not him ? You could&#39;ve been the wife of a grease monkey !&#39; To which Hillary replied &#39;No Bill. If I would have married him you&#39;d be pumping gas and he would be the President !&#39;&quot;,
       &quot;How many feminists does it take to screw in a light bulb?That&#39;s not funny.&quot;,
       &#39;Q. Did you hear about the dyslexic devil worshipper? A. He sold his soul to Santa.&#39;,
       &#39;A country guy goes into a city bar that has a dress code and the maitred\&#39; demands he wear a tie. Discouraged the guy goes to his car to sulk when inspiration strikes: He\&#39;s got jumper cables in the trunk! So he wraps them around his neck sort of like a string tie (a bulky string tie to be sure) and returns to the bar. The maitre d\&#39; is reluctant but says to the guy &quot;Okay you\&#39;re a pretty resourceful fellow you can come in... but just don\&#39;t start anything&quot;!&#39;,
       &#39;Two cannibals are eating a clown one turns to other and says: &quot;Does this taste funny to you?&#39;],
      dtype=&#39;&lt;U1198&#39;)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>b. Complete the definition for the function &quot;test&quot;. This function iterates over all users and for each performs evaluation (by calling the provided &quot;cross_validate_user&quot; function), and returns the error information necessary to compute Mean Absolute Error (MAE). Use this function to perform evaluation (with 20% test-ratio for each user) comparing MAE results using standard item-based collaborative filtering (based on the rating prediction function &quot;standEst&quot;) with results using the SVD-based version of the rating item-based CF (using &quot;svdEst&quot; as the prediction engine).<a rel="noopener" class="anchor-link" href="#b.-Complete-the-definition-for-the-function-%22test%22.-This-function-iterates-over-all-users-and-for-each-performs-evaluation-(by-calling-the-provided-%22cross_validate_user%22-function),-and-returns-the-error-information-necessary-to-compute-Mean-Absolute-Error-(MAE).-Use-this-function-to-perform-evaluation-(with-20%25-test-ratio-for-each-user)-comparing-MAE-results-using-standard-item-based-collaborative-filtering-(based-on-the-rating-prediction-function-%22standEst%22)-with-results-using-the-SVD-based-version-of-the-rating-item-based-CF-(using-%22svdEst%22-as-the-prediction-engine).">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">euclidSim</span><span class="p">(</span><span class="n">userA</span><span class="p">,</span> <span class="n">userB</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Euclidean similarity between two user ratings.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">userA</span> <span class="o">-</span> <span class="n">userB</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">pearsonSim</span><span class="p">(</span><span class="n">userA</span><span class="p">,</span> <span class="n">userB</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Pearson similarity between two user ratings.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">userA</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">userA</span><span class="p">,</span> <span class="n">userB</span><span class="p">,</span> <span class="n">rowvar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">cosineSim</span><span class="p">(</span><span class="n">userA</span><span class="p">,</span> <span class="n">userB</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Cosine similarity between two user ratings.&#39;&#39;&#39;</span>
    <span class="n">dotProduct</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">userA</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">userB</span><span class="p">))</span>
    <span class="n">normProduct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">userA</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">userB</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dotProduct</span><span class="o">/</span><span class="n">normProduct</span><span class="p">)</span>
    <span class="c1">#Rescale to the range [0.5, 1]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">standEst</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns estimated rating (weighted similarity) of the &#39;user&#39; for the &#39;item&#39; using standard item-based collaborative filtering.</span>
<span class="sd">    user: Index of the iterated user. item: index of the iterated joke.&#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#Get total number of jokes/items.</span>
    <span class="n">simTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1">#Total similarity.</span>
    <span class="n">ratSimTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1">#Total weighted similarity.</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">userRating</span> <span class="o">=</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="c1">#Get original rating of iterated &#39;user&#39; for item j-th.</span>
        <span class="k">if</span> <span class="n">userRating</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
        <span class="c1">#If user gives rating=0, we skip.</span>
        
        <span class="n">overLap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">[:,</span><span class="n">item</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">dataMatrix</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#Get index the user who have rated both the current item (item) and item (j-th).</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overLap</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">similarity</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#If ratings are the same, similarity is 0.</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">similarity</span> <span class="o">=</span> <span class="n">simMeas</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">overLap</span><span class="p">,</span><span class="n">item</span><span class="p">],</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">overLap</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
        <span class="c1">#Otherwise, calculate similarity between the ratings of users who have rated both the current item (item) and item (j-th).</span>
        
        <span class="n">simTotal</span> <span class="o">+=</span> <span class="n">similarity</span>
        <span class="c1">#Accumulate similarity.</span>
        <span class="n">ratSimTotal</span> <span class="o">+=</span> <span class="n">similarity</span> <span class="o">*</span> <span class="n">userRating</span>
        <span class="c1">#Accumulate weighted similarity.</span>
        
    <span class="k">if</span> <span class="n">simTotal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#If there is no overlap in rating, returns 0.</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ratSimTotal</span><span class="o">/</span><span class="n">simTotal</span>
    <span class="c1">#Returns weighted similarity of userRating.</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">svdEst</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns estimated rating (weighted similarity) of the &#39;user&#39; for the &#39;item&#39; using SVD-based version of the rating item-based collaborative filtering.</span>
<span class="sd">    user: Index of the iterated user. item: index of the iterated joke.&#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">simTotal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ratSimTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)</span>
    <span class="c1">#Convert to data matrix for Singular Value Decomposition (SVD).</span>
    
    <span class="n">U</span><span class="p">,</span><span class="n">Sigma</span><span class="p">,</span><span class="n">VT</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1">#U, Sigma,and VT form the SVD factorization of dataMatrix.</span>
    
    <span class="n">Sig4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Sigma</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
    <span class="c1">#Using the first 4 singular values from itemBasedRec.py file.</span>
    <span class="c1">#Arrange Sig4 into a diagonal matrix.</span>
    <span class="n">xformedItems</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">U</span><span class="p">[:,:</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">Sig4</span><span class="o">.</span><span class="n">I</span>
    <span class="c1">#Transpose data into Item-User matrix.</span>
    <span class="c1">#Multiply transposed data matrix with the first 4 columns of the U matrix, then multiply with the inverse of Sig4 matrix.</span>
    <span class="c1">#xformedItems represents the transformed items based on the SVD decomposition.</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">userRating</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">userRating</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span><span class="o">==</span><span class="n">item</span><span class="p">:</span> <span class="k">continue</span>
        <span class="c1">#If user gives rating=0 or current iterated item, we skip.</span>
        <span class="n">similarity</span> <span class="o">=</span> <span class="n">simMeas</span><span class="p">(</span><span class="n">xformedItems</span><span class="p">[</span><span class="n">item</span><span class="p">,:],</span> <span class="n">xformedItems</span><span class="p">[</span><span class="n">j</span><span class="p">,:])</span>
        <span class="c1">#Otherwise, calculate similarity between the ratings of users who have rated both the current item (item) and item (j-th).</span>
        <span class="n">simTotal</span> <span class="o">+=</span> <span class="n">similarity</span>
        <span class="n">ratSimTotal</span> <span class="o">+=</span> <span class="n">similarity</span> <span class="o">*</span> <span class="n">userRating</span>
    <span class="k">if</span> <span class="n">simTotal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ratSimTotal</span><span class="o">/</span><span class="n">simTotal</span>
    <span class="c1">#Returns weighted similarity of userRating.</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cross_validateUser</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">testRatio</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Perform cross-validation for given user.</span>
<span class="sd">    Return sum of absolute errors, count of test ratings to compute Mean Absolute Error (MAE).&#39;&#39;&#39;</span>
    
    <span class="n">itemNumbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>   
    <span class="c1">#Get total number of jokes.</span>
    <span class="n">avail_userRating</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">itemNumbers</span><span class="p">)</span> <span class="k">if</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">user</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1">#Get indicies of ratings are available (ratings&gt;0) by the &#39;user&#39;. </span>
    <span class="n">testSize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">testRatio</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">avail_userRating</span><span class="p">))</span>
    
    <span class="c1">#Get total number of ratings withheld for testing based on available ratings per user.</span>
    <span class="n">testIndices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avail_userRating</span><span class="p">),</span> <span class="n">testSize</span><span class="p">)</span>
    <span class="c1">#Generate random indices from the available ratings to select the test items for testing.</span>
    <span class="n">testItems</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">avail_userRating</span><span class="p">)[</span><span class="n">testIndices</span><span class="p">]</span>
    <span class="c1">#Get indicies of test items.</span>
    
    <span class="n">orig_userRating</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">user</span><span class="p">])</span>
    <span class="c1">#Make a copy of original rating of the &#39;user&#39;, including 0 value(s).</span>
    <span class="c1">#orig_userRating has shape (1, 100)</span>
    <span class="n">dataMatrix</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="n">testItems</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="c1">#Set test items values to 0, so they are not used in rating estimation.</span>
    <span class="n">error_userRating</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1">#Initialize counter for absolute error of the &#39;user&#39; ratings.</span>
    <span class="n">count_userRating</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">testItems</span><span class="p">)</span>
    <span class="c1">#Get the count of test items.</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">testItems</span><span class="p">:</span>
        <span class="n">estimatedScore</span> <span class="o">=</span> <span class="n">estMethod</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">simMeas</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="c1">#Estimate rating on test item. </span>
        <span class="n">error_userRating</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">estimatedScore</span> <span class="o">-</span> <span class="n">orig_userRating</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">])</span>
        <span class="c1">#Accumulate absolute error by comparing estimated vs. original rating. </span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">testItems</span><span class="p">:</span>
        <span class="n">dataMatrix</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">orig_userRating</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">]</span>
        <span class="c1">#Restore ratings of the test items to the user original ratings profile.</span>
        
    <span class="k">return</span> <span class="n">error_userRating</span><span class="p">,</span> <span class="n">count_userRating</span>
    <span class="c1">#Return sum of absolute errors and the count of test cases for this user. </span>
    <span class="c1">#Will use this calculate MAE for the entire dataset.</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">testRatio</span><span class="p">,</span> <span class="n">estMethod</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate Mean Absolute Error.&#39;&#39;&#39;</span>
    
    <span class="n">totalErrors</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">totalCounts</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)):</span>
        <span class="n">error_userRating</span><span class="p">,</span> <span class="n">count_userRating</span> <span class="o">=</span> <span class="n">cross_validateUser</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">testRatio</span><span class="p">,</span> <span class="n">estMethod</span><span class="o">=</span><span class="n">standEst</span><span class="p">,</span> <span class="n">simMeas</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">)</span>
        <span class="n">totalErrors</span> <span class="o">+=</span> <span class="n">error_userRating</span>
        <span class="n">totalCounts</span> <span class="o">+=</span> <span class="n">count_userRating</span>
    
    <span class="n">MAE</span> <span class="o">=</span> <span class="n">totalErrors</span><span class="o">/</span><span class="n">totalCounts</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Absolute Error for </span><span class="si">{</span><span class="n">estMethod</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">MAE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jokeRating_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">jokeRating</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> test(jokeRating_matrix, 0.2, standEst)
<span class="c1">#Using standard estimate.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Mean Absolute Error for standEst: 3.6866361996922237
Wall time: 8min 18s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> test(jokeRating_matrix, 0.2, svdEst)
<span class="c1">#Using SVD estimate.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Mean Absolute Error for svdEst: 3.6893545892480515
Wall time: 4min 55s
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The MAE value for standard estimate is 3.6866; and the MAE value for SVD estimate is 3.7159. SVD estimate yields higher MAE than Standard estimate but the indifference gap is not significant. This slight difference shows that both methods perform similarly in rating estimations.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>c. Write a new function &quot;print_most_similar_jokes&quot; which takes the joke ratings data, a query joke id, a parameter k for the number of nearest neighbors, and a similarity metric function, and prints the text of the query joke as well as the texts of the top k most similar jokes based on user ratings.<a rel="noopener" class="anchor-link" href="#c.-Write-a-new-function-%22print_most_similar_jokes%22-which-takes-the-joke-ratings-data,-a-query-joke-id,-a-parameter-k-for-the-number-of-nearest-neighbors,-and-a-similarity-metric-function,-and-prints-the-text-of-the-query-joke-as-well-as-the-texts-of-the-top-k-most-similar-jokes-based-on-user-ratings.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_most_similar_jokes</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">,</span> <span class="n">jokeText</span><span class="p">,</span> <span class="n">jokeID</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">pearsonSim</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Prints the text of the query joke as well as the texts of the top k most similar jokes based on user ratings.&#39;&#39;&#39;</span>
    
    <span class="n">queryJoke_ratings</span> <span class="o">=</span> <span class="n">dataMatrix</span><span class="p">[:,</span> <span class="n">jokeID</span><span class="p">]</span>
    <span class="c1">#Get the ratings of the query joke.</span>
    
    <span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#Compute the similarity scores between the query joke and all other jokes.</span>
    <span class="k">for</span> <span class="n">ratingIndex</span><span class="p">,</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataMatrix</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
        <span class="c1">#Iterate over each joke (transpose rating data to Iterm-User matrix).</span>
        <span class="k">if</span>  <span class="n">ratingIndex</span><span class="o">!=</span> <span class="n">jokeID</span><span class="p">:</span>
        <span class="c1">#Exclue query joke.</span>
            <span class="n">similarity</span> <span class="o">=</span> <span class="n">metric</span><span class="p">(</span><span class="n">queryJoke_ratings</span><span class="p">,</span> <span class="n">ratings</span><span class="p">)</span>
            <span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ratingIndex</span><span class="p">,</span> <span class="n">similarity</span><span class="p">))</span>
            <span class="c1">#Calculate and append similarity.</span>
            
    <span class="n">similarities</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Sort similarities in descending order.</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query Joke: </span><span class="si">{</span><span class="n">jokeText</span><span class="p">[</span><span class="n">jokeID</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="c1">#Print query joke.</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Top </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> Most Similar Jokes:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">jokeIndex</span><span class="p">,</span> <span class="n">similarity</span> <span class="o">=</span> <span class="n">similarities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">sim_jokeText</span> <span class="o">=</span> <span class="n">jokeText</span><span class="p">[</span><span class="n">jokeIndex</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joke ID: </span><span class="si">{</span><span class="n">jokeIndex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Similarity: </span><span class="si">{</span><span class="n">similarity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">sim_jokeText</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">print_most_similar_jokes</span><span class="p">(</span><span class="n">jokeRating_matrix</span><span class="p">,</span> <span class="n">jokeText</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">pearsonSim</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Query Joke: This couple had an excellent relationship going until one day he came home from work to find his girlfriend packing. He asked her why she was leaving him and she told him that she had heard awful things about him. &quot;What could they possibly have said to make you move out?&quot; &quot;They told me that you were a pedophile.&quot; He replied &quot;That&#39;s an awfully big word for a ten year old.&quot;

Top 3 Most Similar Jokes:
Joke ID: 0
Similarity: 0.7858504010765623
A man visits the doctor. The doctor says &quot;I have bad news for you.You have cancer and Alzheimer&#39;s disease&quot;. The man replies &quot;Well thank God I don&#39;t have cancer!&quot;

Joke ID: 2
Similarity: 0.725831124183739
Q. What&#39;s 200 feet long and has 4 teeth? A. The front row at a Willie Nelson Concert.

Joke ID: 36
Similarity: 0.722828904812725
A Jewish young man was seeing a psychiatrist for an eating and sleeping disorder. &quot;I am so obsessed with my mother... As soon as I go to sleep I start dreaming and everyone in my dream turns into my mother. I wake up in such a state all I can do is go downstairs and eat a piece of toast.&quot;The psychiatrist replies:&quot;What just one piece of toast for a big boy like you?&quot;

</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Part B. PCA for Reduced Dimensionality in Clustering.<a rel="noopener" class="anchor-link" href="#Part-B.-PCA-for-Reduced-Dimensionality-in-Clustering.">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>For this problem you will use an image segmentation data set for clustering. You will experiment with using PCA as an approach to reduce dimensionality and noise in the data. You will compare the results of clustering the data with and without PCA using the provided image class assignments as the ground truth. The data set is divided into three files. The file &quot;segmentation_data.txt&quot; contains data about images with each line corresponding to one image. Each image is represented by 19 features (these are the columns in the data and correspond to the feature names in the file &quot;segmentation_names.txt&quot;. The file &quot;segmentation_classes.txt&quot; contains the class labels (the type of image) and a numeric class label for each of the corresponding images in the data file. After clustering the image data, you will use the class labels to measure completeness and homogeneity of the generated clusters. The data set used in this problem is based on the Image Segmentation data set at the UCI Machine Learning Repository.</p>
<p>Your tasks in this problem are the following:</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>a. Load in the image data matrix (with rows as images and columns as features). Also load in the numeric class labels from the segmentation class file. Using your favorite method (e.g., sklearn&#39;s min-max scaler), perform min-max normalization on the data matrix so that each feature is scaled to [0,1] range.<a rel="noopener" class="anchor-link" href="#a.-Load-in-the-image-data-matrix-(with-rows-as-images-and-columns-as-features).-Also-load-in-the-numeric-class-labels-from-the-segmentation-class-file.-Using-your-favorite-method-(e.g.,-sklearn&#39;s-min-max-scaler),-perform-min-max-normalization-on-the-data-matrix-so-that-each-feature-is-scaled-to-%5B0,1%5D-range.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">segData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;segmentation_data.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">segData</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">segData</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#Read data as Pandas dataframe and get number of rows and columns, print first 10 observations.</span>
<span class="c1">#2100 images, 19 features.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Data shape: (2100, 19)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>110.0</td>
      <td>189.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>1.222222</td>
      <td>1.186342</td>
      <td>12.925926</td>
      <td>10.888889</td>
      <td>9.222222</td>
      <td>18.666668</td>
      <td>-6.111111</td>
      <td>-11.111111</td>
      <td>17.222221</td>
      <td>18.666668</td>
      <td>0.508139</td>
      <td>1.910864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>86.0</td>
      <td>187.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.111111</td>
      <td>0.720082</td>
      <td>1.444444</td>
      <td>0.750309</td>
      <td>13.740741</td>
      <td>11.666667</td>
      <td>10.333334</td>
      <td>19.222221</td>
      <td>-6.222222</td>
      <td>-10.222222</td>
      <td>16.444445</td>
      <td>19.222221</td>
      <td>0.463329</td>
      <td>1.941465</td>
    </tr>
    <tr>
      <th>2</th>
      <td>225.0</td>
      <td>244.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>3.388889</td>
      <td>2.195113</td>
      <td>3.000000</td>
      <td>1.520234</td>
      <td>12.259259</td>
      <td>10.333334</td>
      <td>9.333334</td>
      <td>17.111110</td>
      <td>-5.777778</td>
      <td>-8.777778</td>
      <td>14.555555</td>
      <td>17.111110</td>
      <td>0.480149</td>
      <td>1.987902</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.0</td>
      <td>232.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.277778</td>
      <td>1.254621</td>
      <td>1.000000</td>
      <td>0.894427</td>
      <td>12.703704</td>
      <td>11.000000</td>
      <td>9.000000</td>
      <td>18.111110</td>
      <td>-5.111111</td>
      <td>-11.111111</td>
      <td>16.222221</td>
      <td>18.111110</td>
      <td>0.500966</td>
      <td>1.875362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>97.0</td>
      <td>186.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.166667</td>
      <td>0.691215</td>
      <td>1.166667</td>
      <td>1.005540</td>
      <td>15.592592</td>
      <td>13.888889</td>
      <td>11.777778</td>
      <td>21.111110</td>
      <td>-5.111111</td>
      <td>-11.444445</td>
      <td>16.555555</td>
      <td>21.111110</td>
      <td>0.442661</td>
      <td>1.863654</td>
    </tr>
    <tr>
      <th>5</th>
      <td>157.0</td>
      <td>221.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.055556</td>
      <td>0.646930</td>
      <td>1.222222</td>
      <td>0.620633</td>
      <td>12.111111</td>
      <td>10.222222</td>
      <td>8.111112</td>
      <td>18.000000</td>
      <td>-5.666666</td>
      <td>-12.000000</td>
      <td>17.666666</td>
      <td>18.000000</td>
      <td>0.549180</td>
      <td>1.877146</td>
    </tr>
    <tr>
      <th>6</th>
      <td>62.0</td>
      <td>224.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.944445</td>
      <td>1.083547</td>
      <td>2.333334</td>
      <td>1.632993</td>
      <td>14.629630</td>
      <td>13.222222</td>
      <td>11.444445</td>
      <td>19.222221</td>
      <td>-4.222222</td>
      <td>-9.555555</td>
      <td>13.777778</td>
      <td>19.222221</td>
      <td>0.408965</td>
      <td>1.860191</td>
    </tr>
    <tr>
      <th>7</th>
      <td>27.0</td>
      <td>248.0</td>
      <td>9</td>
      <td>0.111111</td>
      <td>0.0</td>
      <td>1.611111</td>
      <td>0.646930</td>
      <td>3.166667</td>
      <td>1.722401</td>
      <td>15.296296</td>
      <td>14.777778</td>
      <td>12.888889</td>
      <td>18.222221</td>
      <td>-1.555556</td>
      <td>-7.222222</td>
      <td>8.777778</td>
      <td>18.222221</td>
      <td>0.312227</td>
      <td>1.783512</td>
    </tr>
    <tr>
      <th>8</th>
      <td>44.0</td>
      <td>233.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>2.222222</td>
      <td>2.146487</td>
      <td>2.111111</td>
      <td>1.327766</td>
      <td>14.481482</td>
      <td>12.555555</td>
      <td>11.333333</td>
      <td>19.555555</td>
      <td>-5.777778</td>
      <td>-9.444445</td>
      <td>15.222222</td>
      <td>19.555555</td>
      <td>0.422174</td>
      <td>1.950405</td>
    </tr>
    <tr>
      <th>9</th>
      <td>17.0</td>
      <td>229.0</td>
      <td>9</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>2.111111</td>
      <td>1.985130</td>
      <td>2.444445</td>
      <td>1.614747</td>
      <td>13.703704</td>
      <td>11.222222</td>
      <td>11.111111</td>
      <td>18.777779</td>
      <td>-7.444445</td>
      <td>-7.777778</td>
      <td>15.222222</td>
      <td>18.777779</td>
      <td>0.439852</td>
      <td>2.099905</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">segClass</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;segmentation_classes.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">segClass</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">segClass</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Data shape: (2100, 2)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GRASS</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">segName</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;segmentation_names.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data shape: </span><span class="si">{</span><span class="n">segClass</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">segName</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Data shape: (2100, 2)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>REGION-CENTROID-COL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>REGION-CENTROID-ROW</td>
    </tr>
    <tr>
      <th>2</th>
      <td>REGION-PIXEL-COUNT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SHORT-LINE-DENSITY-5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SHORT-LINE-DENSITY-2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>VEDGE-MEAN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>VEDGE-SD</td>
    </tr>
    <tr>
      <th>7</th>
      <td>HEDGE-MEAN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>HEDGE-SD</td>
    </tr>
    <tr>
      <th>9</th>
      <td>INTENSITY-MEAN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segData</span><span class="p">)</span>
<span class="n">segData_norm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">segData</span><span class="p">)</span>
<span class="c1">#Apply min-max normalization on the segData matrix so that each feature is scaled to [0,1] range</span>
<span class="n">segData_norm</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([[0.43083004, 0.74166667, 0.        , ..., 0.12371135, 0.50813884,
        0.83184923],
       [0.33596838, 0.73333333, 0.        , ..., 0.12739322, 0.46332908,
        0.83698646],
       [0.88537549, 0.97083333, 0.        , ..., 0.11340205, 0.48014903,
        0.84478233],
       ...,
       [0.50197628, 0.625     , 0.        , ..., 0.07216495, 0.5409177 ,
        0.17591546],
       [0.58893281, 0.6125    , 0.        , ..., 0.08100147, 0.50308645,
        0.18478933],
       [0.48616601, 0.62916667, 0.        , ..., 0.09646539, 0.4799313 ,
        0.17037463]])</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>b. Next, Perform Kmeans clustering (for this problem, use the Kmeans implementation in scikit-learn) on the image data (since there are a total 7 pre-assigned image classes, you should use K = 7 in your clustering). Use Euclidean distance as your distance measure for the clustering. Print the cluster centroids (use some formatting so that they are visually understandable). Compare your 7 clusters to the 7 pre-assigned classes by computing the Completeness and Homogeneity values of the generated clusters.<a rel="noopener" class="anchor-link" href="#b.-Next,-Perform-Kmeans-clustering-(for-this-problem,-use-the-Kmeans-implementation-in-scikit-learn)-on-the-image-data-(since-there-are-a-total-7-pre-assigned-image-classes,-you-should-use-K-=-7-in-your-clustering).-Use-Euclidean-distance-as-your-distance-measure-for-the-clustering.-Print-the-cluster-centroids-(use-some-formatting-so-that-they-are-visually-understandable).-Compare-your-7-clusters-to-the-7-pre-assigned-classes-by-computing-the-Completeness-and-Homogeneity-values-of-the-generated-clusters.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span> <span class="n">homogeneity_score</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">kMeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">kMeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">segData_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[18]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>KMeans(n_clusters=7)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster Centroids:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="n">kMeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">centroid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster Centroids:
[0.25121165 0.39336558 0.         0.07539682 0.01934524 0.07800901
 0.00443644 0.06225598 0.0053475  0.14728647 0.13735819 0.18421041
 0.11752357 0.71839464 0.34356793 0.35466366 0.18452162 0.41410698
 0.20277198]

[5.35098814e-01 1.50166667e-01 0.00000000e+00 2.77777769e-02
 1.66666667e-03 3.02281387e-02 5.42887957e-04 2.67660451e-02
 5.86661900e-04 8.23246433e-01 7.79716377e-01 8.94170356e-01
 7.88760696e-01 2.70665440e-01 6.66372551e-01 2.89386481e-01
 8.94170356e-01 2.11804171e-01 1.25065773e-01]

[0.76906251 0.42593042 0.         0.01402373 0.02265372 0.03970246
 0.00298261 0.02311604 0.00209423 0.04038497 0.03442642 0.05738498
 0.02805924 0.77991717 0.2227946  0.48688616 0.05836205 0.53915212
 0.24498804]

[0.51399369 0.80893659 0.         0.07744108 0.00505051 0.05447376
 0.00140719 0.04633498 0.00140097 0.10878994 0.09140296 0.09241408
 0.14267644 0.67916102 0.07900179 0.82128688 0.1349008  0.41449132
 0.89233263]

[0.30250553 0.53086158 0.         0.05225989 0.04661017 0.10081685
 0.00942022 0.08397199 0.01104328 0.40060809 0.37034723 0.47246075
 0.35303578 0.49714616 0.57088236 0.2130544  0.47246075 0.30226303
 0.16387917]

[0.2541502  0.45938218 0.         0.02643678 0.0137931  0.03679035
 0.00203123 0.02660955 0.00165141 0.02568712 0.01750964 0.04199888
 0.01624694 0.76928076 0.21602029 0.50863052 0.04291047 0.80315741
 0.18040715]

[0.74827373 0.53204066 0.         0.03915663 0.0376506  0.11353017
 0.01892238 0.10731122 0.017627   0.29857308 0.27752095 0.35008073
 0.2638371  0.59330045 0.44924168 0.31145266 0.3501628  0.30304693
 0.1643593 ]

</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Printing cluster centroids</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">kMeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">segName</span><span class="p">)</span>
<span class="n">centroidsTranspose</span> <span class="o">=</span> <span class="n">centroids</span><span class="o">.</span><span class="n">T</span>
<span class="n">centroidsTranspose</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cluster </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centroidsTranspose</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster Centroids:&quot;</span><span class="p">)</span>
<span class="n">centroidsTranspose</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster Centroids:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[20]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster 1</th>
      <th>Cluster 2</th>
      <th>Cluster 3</th>
      <th>Cluster 4</th>
      <th>Cluster 5</th>
      <th>Cluster 6</th>
      <th>Cluster 7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(REGION-CENTROID-COL,)</th>
      <td>0.25</td>
      <td>0.54</td>
      <td>0.77</td>
      <td>0.51</td>
      <td>0.30</td>
      <td>0.25</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>(REGION-CENTROID-ROW,)</th>
      <td>0.39</td>
      <td>0.15</td>
      <td>0.43</td>
      <td>0.81</td>
      <td>0.53</td>
      <td>0.46</td>
      <td>0.53</td>
    </tr>
    <tr>
      <th>(REGION-PIXEL-COUNT,)</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>(SHORT-LINE-DENSITY-5,)</th>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.01</td>
      <td>0.08</td>
      <td>0.05</td>
      <td>0.03</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>(SHORT-LINE-DENSITY-2,)</th>
      <td>0.02</td>
      <td>0.00</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>0.05</td>
      <td>0.01</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>(VEDGE-MEAN,)</th>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.04</td>
      <td>0.05</td>
      <td>0.10</td>
      <td>0.04</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>(VEDGE-SD,)</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>(HEDGE-MEAN,)</th>
      <td>0.06</td>
      <td>0.03</td>
      <td>0.02</td>
      <td>0.05</td>
      <td>0.08</td>
      <td>0.03</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>(HEDGE-SD,)</th>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>(INTENSITY-MEAN,)</th>
      <td>0.15</td>
      <td>0.82</td>
      <td>0.04</td>
      <td>0.11</td>
      <td>0.40</td>
      <td>0.03</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>(RAWRED-MEAN,)</th>
      <td>0.14</td>
      <td>0.78</td>
      <td>0.03</td>
      <td>0.09</td>
      <td>0.37</td>
      <td>0.02</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>(RAWBLUE-MEAN,)</th>
      <td>0.18</td>
      <td>0.89</td>
      <td>0.06</td>
      <td>0.09</td>
      <td>0.47</td>
      <td>0.04</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>(RAWGREEN-MEAN,)</th>
      <td>0.12</td>
      <td>0.79</td>
      <td>0.03</td>
      <td>0.14</td>
      <td>0.35</td>
      <td>0.02</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>(EXRED-MEAN,)</th>
      <td>0.72</td>
      <td>0.27</td>
      <td>0.78</td>
      <td>0.68</td>
      <td>0.50</td>
      <td>0.77</td>
      <td>0.59</td>
    </tr>
    <tr>
      <th>(EXBLUE-MEAN,)</th>
      <td>0.34</td>
      <td>0.67</td>
      <td>0.22</td>
      <td>0.08</td>
      <td>0.57</td>
      <td>0.22</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>(EXGREEN-MEAN,)</th>
      <td>0.35</td>
      <td>0.29</td>
      <td>0.49</td>
      <td>0.82</td>
      <td>0.21</td>
      <td>0.51</td>
      <td>0.31</td>
    </tr>
    <tr>
      <th>(VALUE-MEAN,)</th>
      <td>0.18</td>
      <td>0.89</td>
      <td>0.06</td>
      <td>0.13</td>
      <td>0.47</td>
      <td>0.04</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>(SATURATION-MEAN,)</th>
      <td>0.41</td>
      <td>0.21</td>
      <td>0.54</td>
      <td>0.41</td>
      <td>0.30</td>
      <td>0.80</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>(HUE-MEAN,)</th>
      <td>0.20</td>
      <td>0.13</td>
      <td>0.24</td>
      <td>0.89</td>
      <td>0.16</td>
      <td>0.18</td>
      <td>0.16</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">completeness</span> <span class="o">=</span> <span class="n">completeness_score</span><span class="p">(</span><span class="n">segClass</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">kMeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">homogeneity</span> <span class="o">=</span> <span class="n">homogeneity_score</span><span class="p">(</span><span class="n">segClass</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">kMeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="c1"># Print the completeness and homogeneity scores</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completeness with full normalized dataset: </span><span class="si">{</span><span class="n">completeness</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Homogeneity with full normalized dataset: </span><span class="si">{</span><span class="n">homogeneity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Completeness with full normalized dataset: 0.6116744999910891
Homogeneity with full normalized dataset: 0.6099656393147241
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Completeness score measures how much all data points belong to the same class are assigned to the same cluster. With completeness score = 0.6132 incdicates that 61.32% of data poinits in each class are correctly assigned to the same cluster. \
Homogeneity score measures how much each cluster contains only data points of a certain class label. Homogeneity score = 0.61 indicates that 61% of the data points within each cluster belong to the same class label.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>c. Perform PCA on the normalized image data matrix. You may use the linear algebra package in Numpy or the Decomposition module in scikit-learn (the latter is much more efficient). Analyze the principal components to determine the number, r, of PCs needed to capture at least 95% of variance in the data. Then use these r components as features to transform the data into a reduced dimension space.<a rel="noopener" class="anchor-link" href="#c.-Perform-PCA-on-the-normalized-image-data-matrix.-You-may-use-the-linear-algebra-package-in-Numpy-or-the-Decomposition-module-in-scikit-learn-(the-latter-is-much-more-efficient).-Analyze-the-principal-components-to-determine-the-number,-r,-of-PCs-needed-to-capture-at-least-95%25-of-variance-in-the-data.-Then-use-these-r-components-as-features-to-transform-the-data-into-a-reduced-dimension-space.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">segData_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[23]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([[-6.89082181e-01,  5.32951033e-01,  2.46098334e-01, ...,
        -3.11214082e-09,  1.10281139e-08,  9.50161528e-18],
       [-6.66919524e-01,  5.10674647e-01,  3.37971716e-01, ...,
         2.10646100e-09, -9.82754444e-09, -1.99834032e-17],
       [-7.12027478e-01,  7.70943647e-01, -1.55821890e-01, ...,
         3.11649234e-09,  2.08700501e-09,  3.92440934e-16],
       ...,
       [-5.07744749e-01, -1.29415329e-01, -8.22455123e-02, ...,
        -1.62643372e-09,  3.38481898e-09,  7.38270018e-20],
       [-4.79090569e-01, -8.63446712e-02, -1.58711407e-01, ...,
        -4.39254174e-09,  1.67499503e-09, -1.47433165e-19],
       [-4.42253816e-01, -1.06225249e-01, -4.71272464e-02, ...,
        -3.03500819e-09,  3.98533616e-09,  3.30497068e-19]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Get explained variance ratio</span>
<span class="n">varianceRatio</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">varianceRatio</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[6.07142340e-01 1.31969792e-01 1.01237729e-01 4.54353920e-02
 3.54736114e-02 1.98803550e-02 1.89197030e-02 1.61540880e-02
 1.06560085e-02 7.11337518e-03 3.92203525e-03 1.57500309e-03
 4.89150725e-04 3.14164135e-05 2.36381041e-16 1.58615946e-16
 1.52966845e-16 1.44466875e-16 9.39566232e-35]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">component</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">variance</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">varianceRatio</span><span class="p">:</span>
    <span class="n">variance</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">component</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Component: </span><span class="si">{</span><span class="n">component</span><span class="si">}</span><span class="s2">, Variance: </span><span class="si">{</span><span class="n">variance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Component: 1, Variance: 60.71423396853328
Component: 2, Variance: 73.91121320168928
Component: 3, Variance: 84.03498614256192
Component: 4, Variance: 88.57852534332585
Component: 5, Variance: 92.12588648109569
Component: 6, Variance: 94.11392197960623
Component: 7, Variance: 96.00589227704958
Component: 8, Variance: 97.62130108194518
Component: 9, Variance: 98.68690193362033
Component: 10, Variance: 99.39823945149534
Component: 11, Variance: 99.79044297671412
Component: 12, Variance: 99.9479432861607
Component: 13, Variance: 99.99685835864896
Component: 14, Variance: 99.99999999999994
Component: 15, Variance: 99.99999999999997
Component: 16, Variance: 99.99999999999999
Component: 17, Variance: 100.0
Component: 18, Variance: 100.00000000000001
Component: 19, Variance: 100.00000000000001
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Plotting the scree plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">varianceRatio</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">varianceRatio</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Components&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Variance Explained (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scree Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">varianceRatio</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>From scree plot and component breakdown above, seven components will explain 96% of the variance in the data. Therefore, we will go ahead reduce dimensions to 7 components.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">reduced_segData_norm</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">segData_norm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reduced_segData_norm</span><span class="p">)</span>
<span class="c1">#Transform the data into a reduced dimension space using PCA with 7 components.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[[-0.68908218  0.53295103  0.24609833 ... -0.07643294  0.0478044
  -0.04732089]
 [-0.66691952  0.51067465  0.33797172 ... -0.04117773  0.05655091
  -0.04170747]
 [-0.71202748  0.77094365 -0.15582189 ... -0.16662228  0.04381397
  -0.06069494]
 ...
 [-0.50774475 -0.12941533 -0.08224551 ... -0.02791769 -0.03189182
  -0.10525024]
 [-0.47909057 -0.08634467 -0.15871141 ...  0.00443463 -0.00371285
  -0.08505898]
 [-0.44225382 -0.10622525 -0.04712725 ...  0.01522668 -0.2061659
   0.15294393]]
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>d. Perform Kmeans again, but this time on the lower dimensional transformed data. Then, compute the Completeness and Homogeneity values of the new clusters.<a rel="noopener" class="anchor-link" href="#d.-Perform-Kmeans-again,-but-this-time-on-the-lower-dimensional-transformed-data.-Then,-compute-the-Completeness-and-Homogeneity-values-of-the-new-clusters.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">reduced_kMeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">reduced_kMeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">reduced_segData_norm</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[28]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>KMeans(n_clusters=7)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster Centroids:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">reduced_centroid</span> <span class="ow">in</span> <span class="n">reduced_kMeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reduced_centroid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster Centroids:
[-0.61926803  0.64024955  0.1958285  -0.08685588 -0.06775977  0.00886611
  0.03837202]

[ 0.43588833 -0.10529857  0.1652571   0.233499   -0.04503119 -0.00727238
  0.01504941]

[-0.60370483 -0.35550285  0.10919651 -0.12979947 -0.1309111  -0.02160283
 -0.04388193]

[ 1.41452711  0.0872227   0.03676534 -0.17319537 -0.02992247 -0.00897281
 -0.02157291]

[-0.20742333 -0.24636635  0.15253216  0.05661766  0.13031089 -0.00570357
  0.03304526]

[ 0.17640392  0.04369841 -0.26537004  0.18412442  0.02707514  0.02434118
  0.00326357]

[-0.51157863 -0.06490837 -0.33614472 -0.06536523  0.07880903  0.00623993
 -0.02626065]

</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Printing cluster centroids</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster Centroids:&quot;</span><span class="p">)</span>
<span class="n">reduced_centroids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reduced_kMeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PCA </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reduced_segData_norm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">reduced_centroidsTranspose</span> <span class="o">=</span> <span class="n">reduced_centroids</span><span class="o">.</span><span class="n">T</span>
<span class="n">reduced_centroidsTranspose</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cluster </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reduced_centroidsTranspose</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
<span class="n">reduced_centroidsTranspose</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Cluster Centroids:
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[30]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster 1</th>
      <th>Cluster 2</th>
      <th>Cluster 3</th>
      <th>Cluster 4</th>
      <th>Cluster 5</th>
      <th>Cluster 6</th>
      <th>Cluster 7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PCA 1</th>
      <td>-0.62</td>
      <td>0.44</td>
      <td>-0.60</td>
      <td>1.41</td>
      <td>-0.21</td>
      <td>0.18</td>
      <td>-0.51</td>
    </tr>
    <tr>
      <th>PCA 2</th>
      <td>0.64</td>
      <td>-0.11</td>
      <td>-0.36</td>
      <td>0.09</td>
      <td>-0.25</td>
      <td>0.04</td>
      <td>-0.06</td>
    </tr>
    <tr>
      <th>PCA 3</th>
      <td>0.20</td>
      <td>0.17</td>
      <td>0.11</td>
      <td>0.04</td>
      <td>0.15</td>
      <td>-0.27</td>
      <td>-0.34</td>
    </tr>
    <tr>
      <th>PCA 4</th>
      <td>-0.09</td>
      <td>0.23</td>
      <td>-0.13</td>
      <td>-0.17</td>
      <td>0.06</td>
      <td>0.18</td>
      <td>-0.07</td>
    </tr>
    <tr>
      <th>PCA 5</th>
      <td>-0.07</td>
      <td>-0.05</td>
      <td>-0.13</td>
      <td>-0.03</td>
      <td>0.13</td>
      <td>0.03</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>PCA 6</th>
      <td>0.01</td>
      <td>-0.01</td>
      <td>-0.02</td>
      <td>-0.01</td>
      <td>-0.01</td>
      <td>0.02</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>PCA 7</th>
      <td>0.04</td>
      <td>0.02</td>
      <td>-0.04</td>
      <td>-0.02</td>
      <td>0.03</td>
      <td>0.00</td>
      <td>-0.03</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">reduced_completeness</span> <span class="o">=</span> <span class="n">completeness_score</span><span class="p">(</span><span class="n">segClass</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">reduced_kMeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">reduced_homogeneity</span> <span class="o">=</span> <span class="n">homogeneity_score</span><span class="p">(</span><span class="n">segClass</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">reduced_kMeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="c1"># Print the completeness and homogeneity scores</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completeness with dimensionality reduction: </span><span class="si">{</span><span class="n">reduced_completeness</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Homogeneity with dimensionality reduction: </span><span class="si">{</span><span class="n">reduced_homogeneity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Completeness with dimensionality reduction: 0.6110721173142056
Homogeneity with dimensionality reduction: 0.6094646259197861
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>e. Discuss your observations based on the comparison of the two clustering results.<a rel="noopener" class="anchor-link" href="#e.-Discuss-your-observations-based-on-the-comparison-of-the-two-clustering-results.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completeness with full normalized dataset: </span><span class="si">{</span><span class="n">completeness</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Homogeneity with full normalized dataset: </span><span class="si">{</span><span class="n">homogeneity</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completeness with dimensionality reduction on normalized dataset: </span><span class="si">{</span><span class="n">reduced_completeness</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Homogeneity with dimensionality reduction on normalized dataset: </span><span class="si">{</span><span class="n">reduced_homogeneity</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Completeness with full normalized dataset: 0.6117
Homogeneity with full normalized dataset: 0.6100
Completeness with dimensionality reduction on normalized dataset: 0.6111
Homogeneity with dimensionality reduction on normalized dataset: 0.6095
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The Completeness and Homogeneity score results are very similar before and after dimensionality reduction. From this, for dataset with large number of features, it would be more efficient to run PCA first then clustering for confirmation. This will reduce the computational complexity and improving clustering process efficiency.</p>

</div>
</div>
</div>
</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.6-201/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.6-201/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>